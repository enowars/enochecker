

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>enochecker package &mdash; enochecker  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Deploying the checker" href="guide/deployment.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> enochecker
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="guide/index.html">Checker Development</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.checkerservice">enochecker.checkerservice module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.enochecker">enochecker.enochecker module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.logging">enochecker.logging module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.nosqldict">enochecker.nosqldict module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.results">enochecker.results module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.storeddict">enochecker.storeddict module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.useragents">enochecker.useragents module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker.utils">enochecker.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-enochecker">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">enochecker</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>enochecker package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/enochecker.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="enochecker-package">
<h1>enochecker package<a class="headerlink" href="#enochecker-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-enochecker.checkerservice">
<span id="enochecker-checkerservice-module"></span><h2>enochecker.checkerservice module<a class="headerlink" href="#module-enochecker.checkerservice" title="Permalink to this headline">¶</a></h2>
<p>Flask service to run a checker as HTTP service.</p>
<dl class="py function">
<dt id="enochecker.checkerservice.checker_routes">
<code class="sig-prename descclassname">enochecker.checkerservice.</code><code class="sig-name descname">checker_routes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">checker_cls</span></em>, <em class="sig-param"><span class="n">disable_json_logging</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.checkerservice.checker_routes" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a flask app for the given checker class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>checker_cls</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code>]) – The checker class to use</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">CheckerInfoMessage</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[], <code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A flask app that can be passed to a uWSGI server or run using .run().</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.checkerservice.init_service">
<code class="sig-prename descclassname">enochecker.checkerservice.</code><code class="sig-name descname">init_service</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">checker</span></em>, <em class="sig-param"><span class="n">disable_json_logging</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.checkerservice.init_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a flask app that can be used for WSGI or listen directly.</p>
<p>The Engine may communicate with it over socket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>checker</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code>]) – the checker class to use for check requests.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Flask</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a flask app with post and get routes set, ready for checking.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-enochecker.enochecker">
<span id="enochecker-enochecker-module"></span><h2>enochecker.enochecker module<a class="headerlink" href="#module-enochecker.enochecker" title="Permalink to this headline">¶</a></h2>
<p>Contains the BaseChecker to be used as base for all checkers.</p>
<dl class="py class">
<dt id="enochecker.enochecker.BaseChecker">
<em class="property">class </em><code class="sig-prename descclassname">enochecker.enochecker.</code><code class="sig-name descname">BaseChecker</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">task</span></em>, <em class="sig-param"><span class="n">storage_dir</span><span class="o">=</span><span class="default_value">'/home/runner/work/enochecker/enochecker/docs/.data'</span></em>, <em class="sig-param"><span class="n">use_db_cache</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">json_logging</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>All you base are belong to us. Also all your flags. And checker scripts.</p>
<p>Override the methods given here, then simply init and .run().
Magic.</p>
<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.chain_db">
<em class="property">property </em><code class="sig-name descname">chain_db</code><a class="headerlink" href="#enochecker.enochecker.BaseChecker.chain_db" title="Permalink to this definition">¶</a></dt>
<dd><p>get the team_db entry for the current chain. Short hand version for self.team_db[self.task_chain_id]</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the team_db entry</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.connect">
<code class="sig-name descname">connect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">host</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">retries</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a socket/telnet connection to the remote host.</p>
<p>Use connect(..).get_socket() for the raw socket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>host</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – the host to connect to (defaults to self.address)</p></li>
<li><p><strong>port</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – the port to connect to (defaults to self.port)</p></li>
<li><p><strong>timeout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – timeout on connection (defaults to self.timeout)</p></li>
<li><p><strong>retries</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the amount of times this socket connection should be retried</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#enochecker.utils.SimpleSocket" title="enochecker.utils.SimpleSocket"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleSocket</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A connected Telnet instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.db">
<code class="sig-name descname">db</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">ignore_locks</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.db" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a (global) db by name.</p>
<p>Subsequent calls will return the same db.
Names can be anything, for example the team name, round numbers etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The name of the DB</p></li>
<li><p><strong>ignore_locks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Should only be set if you’re sure-ish keys are never shared between instances.
Manual locking ist still possible.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#enochecker.nosqldict.NoSqlDict" title="enochecker.nosqldict.NoSqlDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoSqlDict</span></code></a>, <a class="reference internal" href="#enochecker.storeddict.StoredDict" title="enochecker.storeddict.StoredDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoredDict</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dict that will be self storing. Alternatively,</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.exploit">
<em class="property">abstract </em><code class="sig-name descname">exploit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.exploit" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this method strictly for testing purposes.</p>
<p>Will hopefully not be called during the actual CTF.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The flag found during the execution of this exploit</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>EnoException on Error or if the flag was not found</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="enochecker.enochecker.BaseChecker.exploit_variants">
<code class="sig-name descname">exploit_variants</code><em class="property">: int</em><em class="property"> = None</em><a class="headerlink" href="#enochecker.enochecker.BaseChecker.exploit_variants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="enochecker.enochecker.BaseChecker.flag_variants">
<code class="sig-name descname">flag_variants</code><em class="property">: int</em><em class="property"> = None</em><a class="headerlink" href="#enochecker.enochecker.BaseChecker.flag_variants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.get_team_db">
<code class="sig-name descname">get_team_db</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">team_id</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.get_team_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the database for a specific team.</p>
<p>Subsequent calls will return the same db.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>team</strong> – Return a db for an other team. If none, the db for the local team will be returned.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#enochecker.nosqldict.NoSqlDict" title="enochecker.nosqldict.NoSqlDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoSqlDict</span></code></a>, <a class="reference internal" href="#enochecker.storeddict.StoredDict" title="enochecker.storeddict.StoredDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoredDict</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The team local db</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.getflag">
<em class="property">abstract </em><code class="sig-name descname">getflag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.getflag" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a flag from the service.</p>
<p>Use self.flag to get the flag that needs to be recovered and self.task_chain_id as a key to retrieve data from the database stored during putflag
On error, raise an EnoException.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>EnoException on error</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.getnoise">
<em class="property">abstract </em><code class="sig-name descname">getnoise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.getnoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve noise in the service.</p>
<p>The noise to be retrieved, can be restored from the database by using the self.task_chain_id used to store it during putflag.
The difference between noise and flag is, tht noise does not have to remain secret for other teams.
This method can be called many times per round. Check which variant is called using self.variant_id.
On error, raise an EnoException.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>EnoException on error</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.global_db">
<em class="property">property </em><code class="sig-name descname">global_db</code><a class="headerlink" href="#enochecker.enochecker.BaseChecker.global_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a global storage shared between all teams and rounds.</p>
<p>Subsequent calls will return the same db.
Prefer db_team_local or db_round_local</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#enochecker.nosqldict.NoSqlDict" title="enochecker.nosqldict.NoSqlDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoSqlDict</span></code></a>, <a class="reference internal" href="#enochecker.storeddict.StoredDict" title="enochecker.storeddict.StoredDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoredDict</span></code></a>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The global db</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.havoc">
<em class="property">abstract </em><code class="sig-name descname">havoc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.havoc" title="Permalink to this definition">¶</a></dt>
<dd><p>Unleash havoc on the app -&gt; Do whatever you must to prove the service still works. Or not.</p>
<p>On error, raise an EnoException.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>EnoException on Error</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="enochecker.enochecker.BaseChecker.havoc_variants">
<code class="sig-name descname">havoc_variants</code><em class="property">: int</em><em class="property"> = None</em><a class="headerlink" href="#enochecker.enochecker.BaseChecker.havoc_variants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.http">
<code class="sig-name descname">http</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span></em>, <em class="sig-param"><span class="n">route</span><span class="o">=</span><span class="default_value">'/'</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scheme</span><span class="o">=</span><span class="default_value">'http'</span></em>, <em class="sig-param"><span class="n">raise_http_errors</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.http" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an http request (requests lib) to the current host.</p>
<p>Caches cookies in self.http_session</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The request method</p></li>
<li><p><strong>params</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – The parameter</p></li>
<li><p><strong>route</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The route</p></li>
<li><p><strong>port</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The remote port in case it has not been specified at creation</p></li>
<li><p><strong>scheme</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The scheme (defaults to http)</p></li>
<li><p><strong>raise_http_errors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, will raise exception on http error codes (4xx, 5xx)</p></li>
<li><p><strong>timeout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – How long we’ll try to connect (default: self.timeout)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>requests.Response</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The response</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.http_get">
<code class="sig-name descname">http_get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">route</span><span class="o">=</span><span class="default_value">'/'</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scheme</span><span class="o">=</span><span class="default_value">'http'</span></em>, <em class="sig-param"><span class="n">raise_http_errors</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.http_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a (http) requests.get to the current host.</p>
<p>Caches cookies in self.http_session</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – The parameter</p></li>
<li><p><strong>route</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The route</p></li>
<li><p><strong>port</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The remote port in case it has not been specified at creation</p></li>
<li><p><strong>scheme</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The scheme (defaults to http)</p></li>
<li><p><strong>raise_http_errors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, will raise exception on http error codes (4xx, 5xx)</p></li>
<li><p><strong>timeout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – How long we’ll try to connect</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>requests.Response</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The response</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.http_post">
<code class="sig-name descname">http_post</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">route</span><span class="o">=</span><span class="default_value">'/'</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scheme</span><span class="o">=</span><span class="default_value">'http'</span></em>, <em class="sig-param"><span class="n">raise_http_errors</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.http_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a (http) requests.post to the current host.</p>
<p>Caches cookies in self.http_session</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – The parameter</p></li>
<li><p><strong>route</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The route</p></li>
<li><p><strong>port</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The remote port in case it has not been specified at creation</p></li>
<li><p><strong>scheme</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The scheme (defaults to http)</p></li>
<li><p><strong>raise_http_errors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, will raise exception on http error codes (4xx, 5xx)</p></li>
<li><p><strong>timeout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – How long we’ll try to connect</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>requests.Response</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The response</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.http_useragent">
<em class="property">property </em><code class="sig-name descname">http_useragent</code><a class="headerlink" href="#enochecker.enochecker.BaseChecker.http_useragent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the useragent for http(s) requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the current useragent</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.http_useragent_randomize">
<code class="sig-name descname">http_useragent_randomize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.http_useragent_randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose a new random http useragent.</p>
<p>Note that http requests will be initialized with a random user agent already.
To retrieve a random useragent without setting it, use random instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the new useragent</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.noise">
<em class="property">property </em><code class="sig-name descname">noise</code><a class="headerlink" href="#enochecker.enochecker.BaseChecker.noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a stable noise value for the current task chain.
Do not use for indexing (use self.task_chain_id instead).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A noise string, unique for each task_chain_id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="enochecker.enochecker.BaseChecker.noise_variants">
<code class="sig-name descname">noise_variants</code><em class="property">: int</em><em class="property"> = None</em><a class="headerlink" href="#enochecker.enochecker.BaseChecker.noise_variants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.putflag">
<em class="property">abstract </em><code class="sig-name descname">putflag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.putflag" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a flag in the service.</p>
<p>In case multiple flags are provided, self.variant_id gives the appropriate flag store to target.
The flag itself can be retrieved from self.flag.
On error, raise an Eno Exception.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An optional attack info string that will be publicly available to help in exploits (e.g. the username of the user to attack)</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>EnoException on error</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.putnoise">
<em class="property">abstract </em><code class="sig-name descname">putnoise</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.putnoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Store noise in the service.</p>
<p>The noise should later be recoverable.
The difference between noise and flag is that noise does not have to remain secret for other teams.
This method can be called multiple times per round. Check which variant is called using self.variant_id.
On error, raise an EnoException.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>EnoException on error</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the checker and catch errors along the way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>method</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">CheckerMethod</span></code>]) – When calling run, you may call a different method than the one passed on Checker creation
using this optional param.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#enochecker.results.CheckerResult" title="enochecker.results.CheckerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">CheckerResult</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A CheckerResult as a representation of the CheckerResult response as definded in the Spec.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.search_flag">
<code class="sig-name descname">search_flag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.search_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for the flag in the input data using the flag_regex and flag_hash.</p>
<p>Used only in the exploit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The flag if it was found, None otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.search_flag_bytes">
<code class="sig-name descname">search_flag_bytes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.BaseChecker.search_flag_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for the flag in the input data using the flag_regex and flag_hash, where flag_regex is interpreted as binary regular expression.</p>
<p>Used only in the exploit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The flag if it was found, None otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.team_db">
<em class="property">property </em><code class="sig-name descname">team_db</code><a class="headerlink" href="#enochecker.enochecker.BaseChecker.team_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the database for the current team.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="#enochecker.nosqldict.NoSqlDict" title="enochecker.nosqldict.NoSqlDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoSqlDict</span></code></a>, <a class="reference internal" href="#enochecker.storeddict.StoredDict" title="enochecker.storeddict.StoredDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoredDict</span></code></a>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The team local db</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.time_remaining">
<em class="property">property </em><code class="sig-name descname">time_remaining</code><a class="headerlink" href="#enochecker.enochecker.BaseChecker.time_remaining" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a remaining time that is safe to be used as timeout.</p>
<p>Includes a buffer of TIME_BUFFER seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A safe number of seconds that may still be used</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.enochecker.BaseChecker.time_running">
<em class="property">property </em><code class="sig-name descname">time_running</code><a class="headerlink" href="#enochecker.enochecker.BaseChecker.time_running" title="Permalink to this definition">¶</a></dt>
<dd><p>How long this checker has been running for.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>time this checker has been running for in seconds</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="enochecker.enochecker.parse_args">
<code class="sig-prename descclassname">enochecker.enochecker.</code><code class="sig-name descname">parse_args</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">argv</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.parse_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the parsed argparser args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>argv</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – argv. Custom argvs. Will default to sys.argv if not provided.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Namespace</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>args object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.enochecker.run">
<code class="sig-prename descclassname">enochecker.enochecker.</code><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">checker_cls</span></em>, <em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a checker, either from cmdline or as uwsgi script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checker</strong> – The checker (subclass of basechecker) to run</p></li>
<li><p><strong>force_service</strong> – if True (non-default), the server will skip arg parsing and immediately spawn the web service.</p></li>
<li><p><strong>args</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – optional parameter, providing parameters</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#enochecker.results.CheckerResult" title="enochecker.results.CheckerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">CheckerResult</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Never returns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.enochecker.warn_deprecated">
<code class="sig-prename descclassname">enochecker.enochecker.</code><code class="sig-name descname">warn_deprecated</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_name</span></em>, <em class="sig-param"><span class="n">new_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.enochecker.warn_deprecated" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a warning for the deprecated feature, include the new name in the log
This needs python development mode or deprecation warnings enabled!</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-enochecker.logging">
<span id="enochecker-logging-module"></span><h2>enochecker.logging module<a class="headerlink" href="#module-enochecker.logging" title="Permalink to this headline">¶</a></h2>
<p>Utilities for sending log messages to a central ELK.</p>
<dl class="py class">
<dt id="enochecker.logging.ELKFormatter">
<em class="property">class </em><code class="sig-prename descclassname">enochecker.logging.</code><code class="sig-name descname">ELKFormatter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">checker</span></em>, <em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">datefmt</span><span class="o">=</span><span class="default_value">'%Y-%m-%dT%H:%M:%S%z'</span></em>, <em class="sig-param"><span class="n">style</span><span class="o">=</span><span class="default_value">'%'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.logging.ELKFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Formatter</span></code></p>
<p>Format log messages for a central ELK.</p>
<dl class="py method">
<dt id="enochecker.logging.ELKFormatter.format">
<code class="sig-name descname">format</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.logging.ELKFormatter.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a LogRecord as a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">LogRecord</span></code>) – the record to format</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the formatted string</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="enochecker.logging.exception_to_string">
<code class="sig-prename descclassname">enochecker.logging.</code><code class="sig-name descname">exception_to_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">excp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.logging.exception_to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Format an exception as a string.</p>
<p>Limits the length of the traceback to 3.
:param ecxp: the exception to format
:rtype: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>
:return: The formatted string</p>
</dd></dl>

</section>
<section id="module-enochecker.nosqldict">
<span id="enochecker-nosqldict-module"></span><h2>enochecker.nosqldict module<a class="headerlink" href="#module-enochecker.nosqldict" title="Permalink to this headline">¶</a></h2>
<p>Backend for team_db based on MongoDB.</p>
<dl class="py class">
<dt id="enochecker.nosqldict.NoSqlDict">
<em class="property">class </em><code class="sig-prename descclassname">enochecker.nosqldict.</code><code class="sig-name descname">NoSqlDict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">checker_name</span><span class="o">=</span><span class="default_value">'BaseChecker'</span></em>, <em class="sig-param"><span class="n">host</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">username</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">password</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logger</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.nosqldict.NoSqlDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.MutableMapping</span></code></p>
<p>A dictionary that is MongoDb backed.</p>
<dl class="py attribute">
<dt id="enochecker.nosqldict.NoSqlDict.dblock">
<code class="sig-name descname">dblock</code><em class="property"> = &lt;unlocked _thread.RLock object owner=0 count=0&gt;</em><a class="headerlink" href="#enochecker.nosqldict.NoSqlDict.dblock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="enochecker.nosqldict.NoSqlDict.get_client">
<em class="property">classmethod </em><code class="sig-name descname">get_client</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">host</span></em>, <em class="sig-param"><span class="n">port</span></em>, <em class="sig-param"><span class="n">username</span></em>, <em class="sig-param"><span class="n">password</span></em>, <em class="sig-param"><span class="n">logger</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.nosqldict.NoSqlDict.get_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Lazily try to get the mongo db connection or creates a new one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>host</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – mongo host</p></li>
<li><p><strong>port</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – mongo port</p></li>
<li><p><strong>username</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – the username to connect to</p></li>
<li><p><strong>password</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – the password to use</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>MongoClient</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.nosqldict.NoSqlDict.persist">
<code class="sig-name descname">persist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.nosqldict.NoSqlDict.persist" title="Permalink to this definition">¶</a></dt>
<dd><p>Persist the changes in the backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="enochecker.nosqldict.value_to_hash">
<code class="sig-prename descclassname">enochecker.nosqldict.</code><code class="sig-name descname">value_to_hash</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.nosqldict.value_to_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a stable hash for a value based on the json representation.</p>
<p>Used to check whether the value in the DB has changed without calling __setitem__, for example when writing to nested dicts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – the value to hash</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>hash in string format</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-enochecker.results">
<span id="enochecker-results-module"></span><h2>enochecker.results module<a class="headerlink" href="#module-enochecker.results" title="Permalink to this headline">¶</a></h2>
<p>Collection of Exception classes to signal the status of the service being checked.</p>
<dl class="py exception">
<dt id="enochecker.results.BrokenCheckerException">
<em class="property">exception </em><code class="sig-prename descclassname">enochecker.results.</code><code class="sig-name descname">BrokenCheckerException</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">internal_message</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.results.BrokenCheckerException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#enochecker.results.EnoException" title="enochecker.results.EnoException"><code class="xref py py-class docutils literal notranslate"><span class="pre">enochecker.results.EnoException</span></code></a></p>
<p>Shouldn’t be raised ever since we catch all abstract Errors.</p>
<p>Used internally if something goes horribly wrong.</p>
<dl class="py attribute">
<dt id="enochecker.results.BrokenCheckerException.result">
<code class="sig-name descname">result</code><em class="property">: enochecker_core.CheckerTaskResult</em><em class="property"> = 'INTERNAL_ERROR'</em><a class="headerlink" href="#enochecker.results.BrokenCheckerException.result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="enochecker.results.BrokenServiceException">
<em class="property">exception </em><code class="sig-prename descclassname">enochecker.results.</code><code class="sig-name descname">BrokenServiceException</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">internal_message</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.results.BrokenServiceException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#enochecker.results.EnoException" title="enochecker.results.EnoException"><code class="xref py py-class docutils literal notranslate"><span class="pre">enochecker.results.EnoException</span></code></a></p>
<p>Indicates a broken Service.</p>
<dl class="py attribute">
<dt id="enochecker.results.BrokenServiceException.result">
<code class="sig-name descname">result</code><em class="property">: enochecker_core.CheckerTaskResult</em><em class="property"> = 'MUMBLE'</em><a class="headerlink" href="#enochecker.results.BrokenServiceException.result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="enochecker.results.CheckerResult">
<em class="property">class </em><code class="sig-prename descclassname">enochecker.results.</code><code class="sig-name descname">CheckerResult</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attack_info</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flag</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.results.CheckerResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="enochecker.results.CheckerResult.from_exception">
<em class="property">static </em><code class="sig-name descname">from_exception</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.results.CheckerResult.from_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a given Exception to an extended CheckerResult including Message
public_message isn’t used anywhere yet</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#enochecker.results.CheckerResult" title="enochecker.results.CheckerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">CheckerResult</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="enochecker.results.EnoException">
<em class="property">exception </em><code class="sig-prename descclassname">enochecker.results.</code><code class="sig-name descname">EnoException</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">internal_message</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.results.EnoException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base error including the Result. Raise a subclass of me once we know what to do.</p>
<dl class="py method">
<dt id="enochecker.results.EnoException.message_contains">
<code class="sig-name descname">message_contains</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">flag</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.results.EnoException.message_contains" title="Permalink to this definition">¶</a></dt>
<dd><p>” If the string is in the message</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="enochecker.results.EnoException.result">
<code class="sig-name descname">result</code><em class="property">: enochecker_core.CheckerTaskResult</em><em class="property"> = 'INTERNAL_ERROR'</em><a class="headerlink" href="#enochecker.results.EnoException.result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="enochecker.results.OfflineException">
<em class="property">exception </em><code class="sig-prename descclassname">enochecker.results.</code><code class="sig-name descname">OfflineException</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">internal_message</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.results.OfflineException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#enochecker.results.EnoException" title="enochecker.results.EnoException"><code class="xref py py-class docutils literal notranslate"><span class="pre">enochecker.results.EnoException</span></code></a></p>
<p>Service was not reachable (at least once) during our checks.</p>
<dl class="py attribute">
<dt id="enochecker.results.OfflineException.result">
<code class="sig-name descname">result</code><em class="property">: enochecker_core.CheckerTaskResult</em><em class="property"> = 'OFFLINE'</em><a class="headerlink" href="#enochecker.results.OfflineException.result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-enochecker.storeddict">
<span id="enochecker-storeddict-module"></span><h2>enochecker.storeddict module<a class="headerlink" href="#module-enochecker.storeddict" title="Permalink to this headline">¶</a></h2>
<p>Backend for team_db based on a local filesystem directory.</p>
<dl class="py class">
<dt id="enochecker.storeddict.StoredDict">
<em class="property">class </em><code class="sig-prename descclassname">enochecker.storeddict.</code><code class="sig-name descname">StoredDict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">base_path</span><span class="o">=</span><span class="default_value">'/home/runner/work/enochecker/enochecker/docs/.data'</span></em>, <em class="sig-param"><span class="n">ignore_locks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">logger</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.StoredDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.MutableMapping</span></code></p>
<p>A dictionary that is filesystem backed.</p>
<p>It will write to disk every few seconds and at exit.
In case python crashes, changes may be gone. :/
Note: Complex won’t be tracked.</p>
<dl class="py method">
<dt id="enochecker.storeddict.StoredDict.is_locked">
<code class="sig-name descname">is_locked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.StoredDict.is_locked" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if the key is currently locked by this process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The key</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if locked by this process, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.storeddict.StoredDict.lock">
<code class="sig-name descname">lock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.StoredDict.lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for a lock.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the key to lock</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.storeddict.StoredDict.mark_dirty">
<code class="sig-name descname">mark_dirty</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.StoredDict.mark_dirty" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually mark an entry as dirty. It will be updated on disk on the next occasion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the key that needs to be stored</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the value contained in the key</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.storeddict.StoredDict.persist">
<code class="sig-name descname">persist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.StoredDict.persist" title="Permalink to this definition">¶</a></dt>
<dd><p>Store all dirty data to disk.</p>
<p>If no data is to be stored, it’s basically free to call.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.storeddict.StoredDict.release">
<code class="sig-name descname">release</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">locked_key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.StoredDict.release" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a file lock.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>locked_key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – the key we locked</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.storeddict.StoredDict.reload">
<code class="sig-name descname">reload</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.StoredDict.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload stored values from disk.</p>
<p>There is usually no reason to call this.
Non persisted changes might be lost.
Only reason would be if another process fiddles with our data concurrently.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="enochecker.storeddict.makedirs">
<code class="sig-prename descclassname">enochecker.storeddict.</code><code class="sig-name descname">makedirs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">exist_ok</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.storeddict.makedirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory.</p>
<p>Creates the parent directories if necessary.</p>
<p>param path: the path to create
param exist_ok: ignore already existing path and do nothing</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-enochecker.useragents">
<span id="enochecker-useragents-module"></span><h2>enochecker.useragents module<a class="headerlink" href="#module-enochecker.useragents" title="Permalink to this headline">¶</a></h2>
<p>Collection of random usernames to make fingerprinting checker traffic harder.</p>
<dl class="py function">
<dt id="enochecker.useragents.random_useragent">
<code class="sig-prename descclassname">enochecker.useragents.</code><code class="sig-name descname">random_useragent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.useragents.random_useragent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random useragent.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A seemingly valid useragent.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-enochecker.utils">
<span id="enochecker-utils-module"></span><h2>enochecker.utils module<a class="headerlink" href="#module-enochecker.utils" title="Permalink to this headline">¶</a></h2>
<p>Collection of utilities for checker development.</p>
<dl class="py class">
<dt id="enochecker.utils.SimpleSocket">
<em class="property">class </em><code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">SimpleSocket</code><span class="sig-paren">(</span><em class="sig-param">host=None</em>, <em class="sig-param">port=0</em>, <em class="sig-param">timeout=&lt;object object&gt;</em>, <em class="sig-param">logger=None</em>, <em class="sig-param">timeout_fun=None</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.SimpleSocket" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pwnlib.tubes.remote.remote</span></code></p>
<p>Convenient socket wrapper using pwnlib’s tubes.remote</p>
<p>Read Pwnlib documentation for more info.</p>
<dl class="py method">
<dt id="enochecker.utils.SimpleSocket.current_default_timeout">
<em class="property">property </em><code class="sig-name descname">current_default_timeout</code><a class="headerlink" href="#enochecker.utils.SimpleSocket.current_default_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the timeout default that should currently be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>current timeout default, either from self.timeout_fun or from timeout.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.utils.SimpleSocket.expect">
<code class="sig-name descname">expect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">regexes</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.SimpleSocket.expect" title="Permalink to this definition">¶</a></dt>
<dd><p>Read until one from a list of a regular expressions matches.</p>
<p>Use this to search for anything.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regexes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Pattern</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – The first argument is a list of regular expressions, either
compiled (re.Pattern instances) or uncompiled (strings).</p></li>
<li><p><strong>timeout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Timeout in seconds. If none, default will be taken.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Match</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Return a tuple of three items: the index in the list of the
first regular expression that matches; the re.Match object
returned; and the text read up till and including the match.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.utils.SimpleSocket.read_all">
<code class="sig-name descname">read_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.SimpleSocket.read_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Read all data until EOF; block until connection closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the complete content until EOF</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.utils.SimpleSocket.read_n_lines">
<code class="sig-name descname">read_n_lines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line_count</span></em>, <em class="sig-param"><span class="n">delimiter</span><span class="o">=</span><span class="default_value">b'\\n'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.SimpleSocket.read_n_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Read n lines from socket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line_count</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the amount of lines to read</p></li>
<li><p><strong>delimiter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]) – what delimeter to use for splitting (could also be non-n)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of lines</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.utils.SimpleSocket.read_until">
<code class="sig-name descname">read_until</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">match</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.SimpleSocket.read_until" title="Permalink to this definition">¶</a></dt>
<dd><p>Read until the expected string has been seen, or a timeout is hit
(default is default socket timeout).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>match</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – what to look for.</p></li>
<li><p><strong>timeout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – default socket timeout override</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns everything until the given math. When no match is found, return whatever is available instead,
possibly the empty string.  Raise EOFError if the connection
is closed and no cooked data is available.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.utils.SimpleSocket.readline_expect">
<code class="sig-name descname">readline_expect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expected</span></em>, <em class="sig-param"><span class="n">read_until</span><span class="o">=</span><span class="default_value">b'\\n'</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exception_message</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.SimpleSocket.readline_expect" title="Permalink to this definition">¶</a></dt>
<dd><p>Read to newline (or read_until string) and assert the presence of a string in the response.</p>
<p>Will raise an exception if failed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>read_until</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]) – Which parameter to read until</p></li>
<li><p><strong>expected</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]) – the expected String to search for in the response</p></li>
<li><p><strong>timeout</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The timeout (uses Telnet default if not passed in)</p></li>
</ul>
</dd>
<dt class="field-even">Return read</dt>
<dd class="field-even"><p>the bytes read</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="enochecker.utils.SimpleSocket.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">buffer</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.SimpleSocket.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a string to the socket.</p>
<p>Can block if the connection is blocked.
May raise socket.error if the connection is closed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>buffer</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]) – The buffer to write</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.assert_equals">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">assert_equals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">o1</span></em>, <em class="sig-param"><span class="n">o2</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">autobyteify</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.assert_equals" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise a BrokenServiceException if o1 != o2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>o1</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – the first object</p></li>
<li><p><strong>o2</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – the second object</p></li>
<li><p><strong>message</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – The exception message in case of an error (optional)</p></li>
<li><p><strong>autobyteify</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – will call ensure_bytes on both parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.assert_in">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">assert_in</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">o1</span></em>, <em class="sig-param"><span class="n">o2</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.assert_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise a BrokenServiceException if o1 not in o2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>o1</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – the object that should be in o2</p></li>
<li><p><strong>o2</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – the object to look in</p></li>
<li><p><strong>message</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – An optional message that will be part of the error</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.assert_true">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">assert_true</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expression</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">autobyteify</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.assert_true" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise a BrokenServiceException if expression is not True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>o1</strong> – the element that should be True</p></li>
<li><p><strong>message</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – The exception message in case of an error (optional)</p></li>
<li><p><strong>autobyteify</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – will call ensure_bytes on both parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.base64ify">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">base64ify</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">altchars</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.base64ify" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the base64 representation of a value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]) – the input string</p></li>
<li><p><strong>altchars</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>]) – base64 encodes using the given altchars (or not, if None)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>base64 representation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.debase64ify">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">debase64ify</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">altchars</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.debase64ify" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode a base64-encoded string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]) – the base64-encoded string</p></li>
<li><p><strong>altchars</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>]) – base64 decodes using the given altchars (or not, if None)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the decoded value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.ensure_bytes">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">ensure_bytes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.ensure_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an object to bytes.</p>
<p>If the input is bytes, the value remains unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – str or bytes (or anything else) to convert to bytes representation</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the bytes representation of the object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.ensure_valid_filename">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">ensure_valid_filename</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">min_length</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.ensure_valid_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a valid file name from the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The input string</p></li>
<li><p><strong>min_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – if the result is smaller than this, the method will fall back to base64.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>all illegal chars stripped or base64ified if it gets too small</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.sha256ify">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">sha256ify</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.sha256ify" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the sha256 hash.</p>
<p>Converts the input to bytes if it is a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>]) – the string</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the hash in hex representation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="enochecker.utils.snake_caseify">
<code class="sig-prename descclassname">enochecker.utils.</code><code class="sig-name descname">snake_caseify</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">camel</span></em><span class="sig-paren">)</span><a class="headerlink" href="#enochecker.utils.snake_caseify" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn camels into snake (-cases).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>camel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – camelOrSnakeWhatever</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>camel_or_snake_whatever</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-enochecker">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-enochecker" title="Permalink to this headline">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="guide/deployment.html" class="btn btn-neutral float-left" title="Deploying the checker" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, enochecker contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>